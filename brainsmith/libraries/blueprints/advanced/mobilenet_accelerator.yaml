# Advanced MobileNet Accelerator Blueprint
# Optimized accelerator for MobileNet architectures with depthwise separable convolutions

name: "mobilenet_accelerator"
description: "Advanced accelerator optimized for MobileNet and efficient CNN architectures"
version: "1.2"
category: "advanced"

# Base configuration
model_type: "mobilenet"
target_platform: "zynq_ultrascale"
optimization_level: "aggressive"

# Configurable parameters for design space exploration
parameters:
  # Advanced folding factors
  folding_factors:
    description: "Optimized parallelization for MobileNet layers"
    depthwise_pe:
      range: [1, 4, 8, 16, 32]
      default: 16
      description: "Processing elements for depthwise convolutions"
    pointwise_pe:
      range: [1, 8, 16, 32, 64]
      default: 32
      description: "Processing elements for pointwise convolutions"
    fc_pe:
      range: [1, 8, 16, 32]
      default: 16
      description: "Processing elements for fully connected layers"
  
  # Advanced memory configuration
  memory_mode:
    values: ["internal_decoupled", "external", "hybrid"]
    default: "hybrid"
    description: "Advanced memory architecture mode"
  
  # MVAU configuration
  mvau_wwidth_max:
    range: [18, 36, 72]
    default: 36
    description: "Maximum width for MVAU weight memory"
  
  # Resource optimization
  resType:
    values: ["lut", "dsp", "mixed"]
    default: "mixed"
    description: "Resource allocation strategy"
  
  # Advanced clocking
  target_clock_ns:
    range: [3.0, 5.0, 8.0, 10.0]
    default: 5.0
    description: "Target clock period for high performance"
  
  # Precision configuration
  weight_width:
    range: [1, 2, 4, 8]
    default: 4
    description: "Weight quantization bit width"
  
  activation_width:
    range: [1, 2, 4, 8]
    default: 4
    description: "Activation quantization bit width"
  
  # Advanced optimizations
  enable_streamlining:
    values: [true, false]
    default: true
    description: "Enable FINN streamlining optimizations"
  
  enable_folding_optimization:
    values: [true, false]
    default: true
    description: "Enable automatic folding factor optimization"
  
  # DMA configuration
  dma_width:
    range: [32, 64, 128, 256]
    default: 128
    description: "DMA interface width in bits"

# Fixed advanced configuration
fpga_part: "xczu7ev-ffvc1156-2-e"
board: "Ultra96-V2"
enable_zynq_ps: true
verification_steps: ["cppsim", "rtlsim", "synthesis"]
enable_vivado_synth: true

# Advanced model characteristics
expected_model:
  input_shape: [1, 3, 224, 224]
  architecture: "mobilenet_v2"
  layers:
    - type: "conv_std"
      name: "conv1"
      kernel_size: [3, 3]
    - type: "depthwise_separable"
      name: "dw_block_1"
      expansion_factor: 1
    - type: "depthwise_separable"
      name: "dw_block_2"
      expansion_factor: 6
    - type: "depthwise_separable"
      name: "dw_block_3"
      expansion_factor: 6
    - type: "global_avg_pool"
      name: "global_pool"
    - type: "fc"
      name: "classifier"

# Advanced performance targets
targets:
  throughput_fps: 120
  power_budget_w: 8.0
  accuracy_drop_max: 0.02
  latency_ms_max: 10.0
  resource_utilization_max:
    lut: 0.8
    dsp: 0.7
    bram: 0.6

# Optimization constraints
constraints:
  min_throughput_fps: 60
  max_power_w: 12.0
  max_latency_ms: 15.0
  min_accuracy: 0.95