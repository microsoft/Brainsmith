# Transformer Base Blueprint V2
# Base configuration for all transformer-based accelerators

name: "transformer_base"
version: "2.0"
description: "Base blueprint for transformer architecture accelerators"
category: "transformers"

# Default nodes for transformer models
nodes:
  # Standard canonical operations for transformers
  canonical_ops:
    available:
      - "LayerNorm"
      - "Add" 
      - "MultiHeadAttention"
      - "MatMul"
      - "Softmax"
      - "Dropout"
    exploration:
      required:
        - "LayerNorm"
        - "Add"
        - "MultiHeadAttention"
        - "MatMul"

  # Hardware kernel mappings for transformers
  hw_kernels:
    available:
      - "MatMul":
          - "matmul_hls"
          - "matmul_rtl"
      - "LayerNorm":
          - "layernorm_hls"
      - "Add":
          - "add_hls"
      - "Softmax":
          - "softmax_hls"
    exploration:
      required:
        - "MatMul"
        - "LayerNorm"

# Default transforms for transformer models
transforms:
  # Model topology transformations
  model_topology:
    available:
      - "cleanup"
      - "streamlining"
      - "normalize_ops"
    exploration:
      required:
        - "cleanup"

  # Hardware kernel transformations
  hw_kernel:
    available:
      - "apply_folding_config"
      - "optimize_parallelization"
    exploration:
      required:
        - "apply_folding_config"

# Default DSE strategies for transformers
dse_strategies:
  primary_strategy: "balanced"
  strategies:
    balanced:
      description: "Balanced exploration of performance and resource usage"
      max_evaluations: 10
      sampling: "grid"
      focus_areas: ["throughput", "latency"]

# Default objectives for transformer models
objectives:
  - name: "throughput"
    direction: "maximize"
    weight: 0.6
    target_value: 1000.0
    description: "Target inference throughput (ops/sec)"

  - name: "latency"
    direction: "minimize" 
    weight: 0.4
    target_value: 10.0
    description: "Target inference latency (ms)"

# Default constraints for transformer models
constraints:
  - name: "max_lut_utilization"
    operator: "<="
    value: 0.80
    description: "Maximum LUT utilization"

  - name: "max_dsp_utilization"
    operator: "<="
    value: 0.70
    description: "Maximum DSP utilization"

  - name: "max_bram_utilization"
    operator: "<="
    value: 0.60
    description: "Maximum BRAM utilization"

# Default platform settings
platform:
  target_device: "xczu7ev-ffvc1156-2-e"
  board: "V80"
  target_frequency: 200
  enable_zynq_ps: true
  shell_flow_type: "vivado_zynq"

# Default validation settings
validation:
  verify_functional_equivalence: true
  performance_regression_threshold: 0.1
  accuracy_drop_threshold: 0.05
  test_vectors_required: true

# Default build configuration
build_configuration:
  run_fifo_sizing: true
  generate_dcp: true
  enable_verification: true
  auto_fifo_depths: false
  save_intermediate_models: true