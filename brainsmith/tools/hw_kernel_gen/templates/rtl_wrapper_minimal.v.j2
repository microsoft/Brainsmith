{#-
Minimalist RTL Wrapper Template

This template generates clean Verilog wrappers with:
- Templated parameters from the original module
- Simple port connections
- Minimal structure following the OLD template reference
-#}
// Auto-generated by Brainsmith Hardware Kernel Generator
// Generated from: {{ source_file }}
// Date: {{ generation_timestamp }}

module {{ kernel_name }}_wrapper #(
    // Parameters from original module
{% for param in parameter_definitions %}
    parameter {{ param.name }} = {{ param.template_param_name }}{% if not loop.last %},{% endif %}{{ "\n" if not loop.last else "" }}{% endfor -%}
) (
    // Global Control
    input wire ap_clk,
    input wire ap_rst_n,
    input wire ap_start,
    output wire ap_done,
    output wire ap_idle,
    output wire ap_ready{% if input_interfaces|length + output_interfaces|length + weight_interfaces|length + config_interfaces|length > 0 %},{% endif %}

{#- Input interfaces -#}
{% for interface in input_interfaces %}
{{ "\n" if loop.first else "" }}    // {{ interface.name }}: INPUT interface
    input wire [{{ interface.name }}_TDATA_WIDTH-1:0] {{ interface.name }}_TDATA,
    input wire {{ interface.name }}_TVALID,
    output wire {{ interface.name }}_TREADY{% if not loop.last or output_interfaces|length + weight_interfaces|length + config_interfaces|length > 0 %},{% endif %}
{% endfor %}

{#- Output interfaces -#}
{% for interface in output_interfaces %}
{{ "\n" if loop.first else "" }}    // {{ interface.name }}: OUTPUT interface
    output wire [{{ interface.name }}_TDATA_WIDTH-1:0] {{ interface.name }}_TDATA,
    output wire {{ interface.name }}_TVALID,
    input wire {{ interface.name }}_TREADY{% if not loop.last or weight_interfaces|length + config_interfaces|length > 0 %},{% endif %}
{% endfor %}

{#- Weight interfaces -#}
{% for interface in weight_interfaces %}
{{ "\n" if loop.first else "" }}    // {{ interface.name }}: WEIGHT interface
    input wire [{{ interface.name }}_TDATA_WIDTH-1:0] {{ interface.name }}_TDATA,
    input wire {{ interface.name }}_TVALID,
    output wire {{ interface.name }}_TREADY{% if not loop.last or config_interfaces|length > 0 %},{% endif %}
{% endfor %}

{#- Config interfaces -#}
{% for interface in config_interfaces %}
{{ "\n" if loop.first else "" }}    // {{ interface.name }}: CONFIG interface (AXI-Lite)
    input wire {{ interface.name }}_AWVALID,
    output wire {{ interface.name }}_AWREADY,
    input wire [31:0] {{ interface.name }}_AWADDR,
    input wire {{ interface.name }}_WVALID,
    output wire {{ interface.name }}_WREADY,
    input wire [31:0] {{ interface.name }}_WDATA,
    input wire [3:0] {{ interface.name }}_WSTRB,
    output wire {{ interface.name }}_BVALID,
    input wire {{ interface.name }}_BREADY,
    output wire [1:0] {{ interface.name }}_BRESP,
    input wire {{ interface.name }}_ARVALID,
    output wire {{ interface.name }}_ARREADY,
    input wire [31:0] {{ interface.name }}_ARADDR,
    output wire {{ interface.name }}_RVALID,
    input wire {{ interface.name }}_RREADY,
    output wire [31:0] {{ interface.name }}_RDATA,
    output wire [1:0] {{ interface.name }}_RRESP{% if not loop.last %},{% endif %}
{% endfor %}
);

    // Instantiate the wrapped kernel
    {{ kernel_name }} #(
        // Pass parameters
{% for param in parameter_definitions %}
        .{{ param.name }}({{ param.name }}){% if not loop.last %},{% endif %}{{ "\n" if not loop.last else "" }}{% endfor %}
    ) {{ kernel_name }}_inst (
        // Global control
        .ap_clk(ap_clk),
        .ap_rst_n(ap_rst_n),
        .ap_start(ap_start),
        .ap_done(ap_done),
        .ap_idle(ap_idle),
        .ap_ready(ap_ready){% if input_interfaces|length + output_interfaces|length + weight_interfaces|length + config_interfaces|length > 0 %},{% endif %}

{#- Connect interfaces -#}
{% for interface in input_interfaces %}
{{ "\n" if loop.first else "" }}        // {{ interface.name }} connections
        .{{ interface.name }}_TDATA({{ interface.name }}_TDATA),
        .{{ interface.name }}_TVALID({{ interface.name }}_TVALID),
        .{{ interface.name }}_TREADY({{ interface.name }}_TREADY){% if not loop.last or output_interfaces|length + weight_interfaces|length + config_interfaces|length > 0 %},{% endif %}
{% endfor %}
{% for interface in output_interfaces %}
{{ "\n" if loop.first else "" }}        // {{ interface.name }} connections
        .{{ interface.name }}_TDATA({{ interface.name }}_TDATA),
        .{{ interface.name }}_TVALID({{ interface.name }}_TVALID),
        .{{ interface.name }}_TREADY({{ interface.name }}_TREADY){% if not loop.last or weight_interfaces|length + config_interfaces|length > 0 %},{% endif %}
{% endfor %}
{% for interface in weight_interfaces %}
{{ "\n" if loop.first else "" }}        // {{ interface.name }} connections
        .{{ interface.name }}_TDATA({{ interface.name }}_TDATA),
        .{{ interface.name }}_TVALID({{ interface.name }}_TVALID),
        .{{ interface.name }}_TREADY({{ interface.name }}_TREADY){% if not loop.last or config_interfaces|length > 0 %},{% endif %}
{% endfor %}
{% for interface in config_interfaces %}
{{ "\n" if loop.first else "" }}        // {{ interface.name }} connections
        .{{ interface.name }}_AWVALID({{ interface.name }}_AWVALID),
        .{{ interface.name }}_AWREADY({{ interface.name }}_AWREADY),
        .{{ interface.name }}_AWADDR({{ interface.name }}_AWADDR),
        .{{ interface.name }}_WVALID({{ interface.name }}_WVALID),
        .{{ interface.name }}_WREADY({{ interface.name }}_WREADY),
        .{{ interface.name }}_WDATA({{ interface.name }}_WDATA),
        .{{ interface.name }}_WSTRB({{ interface.name }}_WSTRB),
        .{{ interface.name }}_BVALID({{ interface.name }}_BVALID),
        .{{ interface.name }}_BREADY({{ interface.name }}_BREADY),
        .{{ interface.name }}_BRESP({{ interface.name }}_BRESP),
        .{{ interface.name }}_ARVALID({{ interface.name }}_ARVALID),
        .{{ interface.name }}_ARREADY({{ interface.name }}_ARREADY),
        .{{ interface.name }}_ARADDR({{ interface.name }}_ARADDR),
        .{{ interface.name }}_RVALID({{ interface.name }}_RVALID),
        .{{ interface.name }}_RREADY({{ interface.name }}_RREADY),
        .{{ interface.name }}_RDATA({{ interface.name }}_RDATA),
        .{{ interface.name }}_RRESP({{ interface.name }}_RRESP){% if not loop.last %},{% endif %}
{% endfor %}
    );

endmodule // {{ kernel_name }}_wrapper