name: "BERT"
description: "string"

# extends: "base.yaml"

# Global configursation - all fields optional, can be flat or under global_config
output_stage: "compile_and_package"    # generate_reports | compile_and_package | synthesize_bitstream
working_directory: "work"               # Default: "work"
save_intermediate_models: false         # Default: false
fail_fast: false                        # Default: false
max_combinations: 100000                # Or env BRAINSMITH_MAX_COMBINATIONS
timeout_minutes: 60                     # Or env BRAINSMITH_TIMEOUT_MINUTES

# Smithy parameters (mapped to FINN config)
platform: "V80"                     # Maps to finn_config.board
target_clk: 5                       # Maps to finn_config.synth_clk_period_ns
                                       # Supports units: ps, ns, us, ms (default: ns)

design_space:
  # Legacy FINN backend only uses build_steps, not kernels
  kernels:
    - LayerNorm
    - DuplicateStreams
    # model = model.transform(to_hw.InferDuplicateStreamsLayer())
    - ElementwiseBinary
    - Shuffle
    - Softmax
    - Thresholding
    - MVAU
    
  # Build steps from original bert.py BUILD_STEPS list (lines 380-402)
  steps:
    # Note: First step (cleanup) is handled by child blueprints
    - "qonnx_to_finn"  # custom_step_qonnx2finn
    # Topology optimization
    - "bert_streamlining"
    - "infer_hardware"  # custom_step_infer_hardware
    # Core FINN steps
    - "create_dataflow_partition"
    - "specialize_layers"
    - "target_fps_parallelization"
    - "apply_folding_config"
    - "minimize_bit_width"
    - "generate_estimate_reports"
    - "hw_codegen"
    - "hw_ipgen"
    - "set_fifo_depths"
    - "create_stitched_ip"
    - "measure_rtlsim_performance"